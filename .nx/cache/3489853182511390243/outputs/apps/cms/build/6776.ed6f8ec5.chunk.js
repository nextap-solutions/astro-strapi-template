"use strict";(self.webpackChunkcms=self.webpackChunkcms||[]).push([[6776],{46776:(F,g,t)=>{t.d(g,{ProtectedListView:()=>dt});var s=t(91320),P=t(38239),B=t(20674),K=t(64062),i=t(68210),A=t(44137),o=t(6264),L=t(58780),h=t(58686),W=t(22310),_=t(67645),U=t(54769),I=t(5676),x=t(71179),f=t(79377),T=t(73047),y=t(37272),$=t(98297),Q=t(69158),Y=t(51896),k=t(85904),j=t(70644),H=t(39112),J=t(32805),z=t(84770),G=t(67652),a=t(13768),d=t(99321),l=t(90217),M=t(76350),D=t(96110),E=t(76251),r=t(21977),C=t(49470),O=t(17141),R=t(21681),X=t(38506),w=t(99135),b=t(52800),q=t(62643),tt=t(2863),e=t(4626),st=t(50589),u=t(77315),Ct=t(89775),gt=t(56302),vt=t(75376),Lt=t(50024),ht=t(92585),Ut=t(64706),It=t(98064),Rt=t(87282),Bt=t(10112),Kt=t(13406),Wt=t(35577),xt=t(73607),yt=t(38243),jt=t(23889),ut=t(18334),St=t(7405);const ot=[{name:"name",key:"name",metadatas:{label:{id:"Settings.tokens.ListView.headers.name",defaultMessage:"Name"},sortable:!0}},{name:"description",key:"description",metadatas:{label:{id:"Settings.tokens.ListView.headers.description",defaultMessage:"Description"},sortable:!1}},{name:"createdAt",key:"createdAt",metadatas:{label:{id:"Settings.tokens.ListView.headers.createdAt",defaultMessage:"Created at"},sortable:!1}},{name:"lastUsedAt",key:"lastUsedAt",metadatas:{label:{id:"Settings.tokens.ListView.headers.lastUsedAt",defaultMessage:"Last used"},sortable:!1}}],_t=()=>{(0,o.go)();const{formatMessage:c}=(0,_.Z)(),v=(0,o.lm)(),rt=(0,I.v9)(f.s),{allowedActions:{canCreate:S,canDelete:Et,canUpdate:it,canRead:m}}=(0,o.ss)(rt.settings["transfer-tokens"]),{push:at}=(0,x.k6)(),{trackUsage:p}=(0,o.rS)(),{startSection:lt}=(0,o.c1)(),nt=P.useRef(lt),{get:Mt,del:Dt}=(0,o.kY)();P.useEffect(()=>{nt.current&&nt.current("transferTokens")},[]),P.useEffect(()=>{at({search:W.stringify({sort:"name:ASC"},{encode:!1})})},[at]);const Ot=ot.map(n=>({...n,metadatas:{...n.metadatas,label:c(n.metadatas.label)}})),{data:N,status:Z,isFetching:Pt,refetch:Tt}=(0,U.useQuery)(["transfer-tokens"],async()=>{p("willAccessTokenList",{tokenType:T.T});const{data:{data:n}}=await Mt("/admin/transfer/tokens");return p("didAccessTokenList",{number:n.length,tokenType:T.T}),n},{enabled:m,onError(n){n instanceof h.d7&&(n?.response?.data?.error?.details?.code==="INVALID_TOKEN_SALT"?v({type:"warning",message:{id:"notification.error.invalid.configuration",defaultMessage:"You have an invalid configuration, check your server log for more information."}}):v({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}}))}}),et=m&&(Z!=="success"&&Z!=="error"||Z==="success"&&Pt),ct=(0,U.useMutation)(async n=>{await Dt(`/admin/transfer/tokens/${n}`)},{async onSuccess(){await Tt(["transfer-tokens"])},onError(n){n instanceof h.d7&&(n?.response?.data?.data?v({type:"warning",message:n.response.data.data}):n?.response?.data?.error?.details?.code==="INVALID_TOKEN_SALT"?v({type:"warning",message:{id:"notification.error.invalid.configuration",defaultMessage:"You have an invalid configuration, check your server log for more information."}}):v({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}}))}}),V=N&&N?.length>0,mt=m&&V,At=m&&!V&&!S,ft=m&&!V&&S;return(0,s.jsxs)(B.o,{"aria-busy":et,children:[(0,s.jsx)(o.SL,{name:"Transfer Tokens"}),(0,s.jsx)(K.T,{title:c({id:"Settings.transferTokens.title",defaultMessage:"Transfer Tokens"}),subtitle:c({id:"Settings.transferTokens.description",defaultMessage:'"List of generated transfer tokens"'}),primaryAction:S?(0,s.jsx)(i.Q,{"data-testid":"create-transfer-token-button",startIcon:(0,s.jsx)(L.Z,{}),size:"S",onClick:()=>p("willAddTokenFromList",{tokenType:T.T}),to:"/settings/transfer-tokens/create",children:c({id:"Settings.transferTokens.create",defaultMessage:"Create new Transfer Token"})}):void 0}),(0,s.jsxs)(A.D,{children:[!m&&(0,s.jsx)(o.ZF,{}),mt&&(0,s.jsx)(y.T,{permissions:{canRead:m,canDelete:Et,canUpdate:it},headers:Ot,contentType:"trasfer-tokens",isLoading:et,onConfirmDelete:n=>ct.mutateAsync(n),tokens:N,tokenType:T.T}),ft&&(0,s.jsx)(o.dJ,{content:{id:"Settings.transferTokens.addFirstToken",defaultMessage:"Add your first Transfer Token"},action:(0,s.jsx)(i.Q,{variant:"secondary",startIcon:(0,s.jsx)(L.Z,{}),to:"/settings/transfer-tokens/create",children:c({id:"Settings.transferTokens.addNewToken",defaultMessage:"Add new Transfer Token"})})}),At&&(0,s.jsx)(o.dJ,{content:{id:"Settings.transferTokens.emptyStateLayout",defaultMessage:"You don\u2019t have any content yet..."}})]})]})},dt=()=>{const c=(0,I.v9)(f.s);return(0,s.jsx)(o.O4,{permissions:c.settings?.["transfer-tokens"].main,children:(0,s.jsx)(_t,{})})}},37272:(F,g,t)=>{t.d(g,{T:()=>Q});var s=t(91320),P=t(38239),B=t(22255),K=t(69372),i=t(25587),A=t(70946),o=t(65676),L=t(92422),h=t(58767),W=t(6092),_=t(6264),U=t(59712),I=t(62545),x=t(60410),f=t(67645),T=t(71179),y=t(42977),$=t(9714);const Q=({permissions:a,headers:d=[],contentType:l,isLoading:M=!1,tokens:D=[],onConfirmDelete:E,tokenType:r})=>{const{canDelete:C,canUpdate:O,canRead:R}=a;return(0,s.jsx)(_.tM,{headers:d,contentType:l,rows:D,withBulkActions:C||O||R,isLoading:M,onConfirmDelete:E,children:(0,s.jsx)(Y,{tokenType:r,permissions:a,onConfirmDelete:E})})},Y=({tokenType:a,permissions:d,rows:l=[],withBulkActions:M,onConfirmDelete:D})=>{const{canDelete:E,canUpdate:r,canRead:C}=d,[{query:O}]=(0,_.Kx)(),{formatMessage:R}=(0,f.Z)(),[,X]=O&&O.sort?O.sort.split(":"):[void 0,"ASC"],{push:w,location:{pathname:b}}=(0,T.k6)(),{trackUsage:q}=(0,_.rS)(),tt=l.sort((e,st)=>{const u=e.name.localeCompare(st.name);return X==="DESC"?-u:u});return(0,s.jsx)(B.p,{children:tt.map(e=>(0,s.jsxs)(K.Tr,{...(0,_.X7)({fn(){q("willEditTokenFromList",{tokenType:a}),w(`${b}/${e.id}`)},condition:r}),children:[(0,s.jsx)(i.Td,{maxWidth:(0,_.Q1)(250),children:(0,s.jsx)(A.Z,{textColor:"neutral800",fontWeight:"bold",ellipsis:!0,children:e.name})}),(0,s.jsx)(i.Td,{maxWidth:(0,_.Q1)(250),children:(0,s.jsx)(A.Z,{textColor:"neutral800",ellipsis:!0,children:e.description})}),(0,s.jsx)(i.Td,{children:(0,s.jsx)(A.Z,{textColor:"neutral800",children:(0,s.jsx)(_.ij,{timestamp:new Date(e.createdAt)})})}),(0,s.jsx)(i.Td,{children:e.lastUsedAt&&(0,s.jsx)(A.Z,{textColor:"neutral800",children:(0,s.jsx)(_.ij,{timestamp:new Date(e.lastUsedAt),customIntervals:[{unit:"hours",threshold:1,text:R({id:"Settings.apiTokens.lastHour",defaultMessage:"last hour"})}]})})}),M&&(0,s.jsx)(i.Td,{children:(0,s.jsxs)(o.k,{justifyContent:"end",children:[r&&(0,s.jsx)(G,{tokenName:e.name,tokenId:e.id}),!r&&C&&(0,s.jsx)(z,{tokenName:e.name,tokenId:e.id}),E&&(0,s.jsx)(J,{tokenName:e.name,onClickDelete:()=>D?.(e.id),tokenType:a})]})})]},e.id))})},k={edit:{id:"app.component.table.edit",defaultMessage:"Edit {target}"},read:{id:"app.component.table.read",defaultMessage:"Read {target}"}},j=({tokenName:a,tokenId:d,buttonType:l="edit",children:M})=>{const{formatMessage:D}=(0,f.Z)(),{location:{pathname:E}}=(0,T.k6)();return(0,s.jsx)(H,{forwardedAs:y.OL,to:`${E}/${d}`,title:D(k[l],{target:a}),children:M})},H=(0,$.ZP)(W.r)`
  svg {
    path {
      fill: ${({theme:a})=>a.colors.neutral500};
    }
  }

  &:hover,
  &:focus {
    svg {
      path {
        fill: ${({theme:a})=>a.colors.neutral800};
      }
    }
  }
`,J=({tokenName:a,onClickDelete:d,tokenType:l})=>{const{formatMessage:M}=(0,f.Z)(),{trackUsage:D}=(0,_.rS)(),[E,r]=P.useState(!1),C=()=>{r(!1),D("willDeleteToken",{tokenType:l}),d()};return(0,s.jsxs)(L.x,{paddingLeft:1,onClick:O=>O.stopPropagation(),children:[(0,s.jsx)(h.h,{onClick:()=>{r(!0)},label:M({id:"global.delete-target",defaultMessage:"Delete {target}"},{target:`${a}`}),name:"delete",borderWidth:0,icon:(0,s.jsx)(U.Z,{})}),(0,s.jsx)(_.QH,{onToggleDialog:()=>r(!1),onConfirm:C,isOpen:E})]})},z=({tokenName:a,tokenId:d})=>(0,s.jsx)(j,{tokenName:a,tokenId:d,buttonType:"read",children:(0,s.jsx)(I.Z,{})}),G=({tokenName:a,tokenId:d})=>(0,s.jsx)(j,{tokenName:a,tokenId:d,children:(0,s.jsx)(x.Z,{})})},73047:(F,g,t)=>{t.d(g,{A:()=>s,T:()=>P});const s="api-token",P="transfer-token"}}]);
